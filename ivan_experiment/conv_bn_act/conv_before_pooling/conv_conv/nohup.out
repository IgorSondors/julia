2023-01-12 04:35:59.894181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
/home/ubuntu/anaconda3/envs/py39/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.23.1
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
2023-01-12 04:36:01.069106: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-01-12 04:36:01.070532: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-01-12 04:36:01.225996: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:01.229138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:06.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.56GiB deviceMemoryBandwidth: 298.08GiB/s
2023-01-12 04:36:01.229185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-12 04:36:01.231964: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-01-12 04:36:01.232068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2023-01-12 04:36:01.234515: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-01-12 04:36:01.234960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-01-12 04:36:01.238087: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-01-12 04:36:01.239608: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2023-01-12 04:36:01.245417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-01-12 04:36:01.245594: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:01.248306: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:01.250865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-01-12 04:36:01.286521: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-01-12 04:36:01.288939: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-01-12 04:36:01.289153: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:01.291791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:06.0 name: Tesla T4 computeCapability: 7.5
coreClock: 1.59GHz coreCount: 40 deviceMemorySize: 14.56GiB deviceMemoryBandwidth: 298.08GiB/s
2023-01-12 04:36:01.291835: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-12 04:36:01.291871: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-01-12 04:36:01.291911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2023-01-12 04:36:01.291920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-01-12 04:36:01.291928: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-01-12 04:36:01.291941: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-01-12 04:36:01.291968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2023-01-12 04:36:01.291978: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-01-12 04:36:01.292056: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:01.294743: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:01.297322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-01-12 04:36:01.297390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-12 04:36:02.005185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-01-12 04:36:02.005270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-01-12 04:36:02.005279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-01-12 04:36:02.005540: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:02.007789: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:02.009313: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-01-12 04:36:02.010838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 13770 MB memory) -> physical GPU (device: 0, name: Tesla T4, pci bus id: 0000:00:06.0, compute capability: 7.5)
np.shape(wn) =  (None, 128, 128, 3)
np.shape(dct) =  (None, 128, 128, 3)
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 128, 3) 0                                            
__________________________________________________________________________________________________
white_norm_dct (Lambda)         (None, 128, 128, 3)  0           input_1[0][0]                    
__________________________________________________________________________________________________
dct (Lambda)                    (None, 128, 128, 3)  0           white_norm_dct[0][0]             
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 126, 126, 32) 864         dct[0][0]                        
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 126, 126, 32) 128         conv2d[0][0]                     
__________________________________________________________________________________________________
activation (Activation)         (None, 126, 126, 32) 0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 124, 124, 32) 9216        activation[0][0]                 
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 124, 124, 32) 128         conv2d_1[0][0]                   
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 124, 124, 32) 0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
average_pooling2d (AveragePooli (None, 62, 62, 32)   0           activation_1[0][0]               
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 32)           0           average_pooling2d[0][0]          
__________________________________________________________________________________________________
dense (Dense)                   (None, 16)           528         global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 32)           544         dense[0][0]                      
__________________________________________________________________________________________________
multiply (Multiply)             (None, 62, 62, 32)   0           dense_1[0][0]                    
                                                                 average_pooling2d[0][0]          
__________________________________________________________________________________________________
conv2_dct (Conv2D)              (None, 60, 60, 32)   9248        multiply[0][0]                   
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 60, 60, 32)   128         conv2_dct[0][0]                  
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 60, 60, 32)   0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
average_pooling2d_1 (AveragePoo (None, 30, 30, 32)   0           activation_2[0][0]               
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 32)           0           average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 16)           528         global_average_pooling2d_1[0][0] 
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 32)           544         dense_2[0][0]                    
__________________________________________________________________________________________________
multiply_1 (Multiply)           (None, 30, 30, 32)   0           dense_3[0][0]                    
                                                                 average_pooling2d_1[0][0]        
__________________________________________________________________________________________________
conv3_dct (Conv2D)              (None, 28, 28, 32)   9248        multiply_1[0][0]                 
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 28, 28, 32)   128         conv3_dct[0][0]                  
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 28, 28, 32)   0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
average_pooling2d_2 (AveragePoo (None, 14, 14, 32)   0           activation_3[0][0]               
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 32)           0           average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 16)           528         global_average_pooling2d_2[0][0] 
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 32)           544         dense_4[0][0]                    
__________________________________________________________________________________________________
multiply_2 (Multiply)           (None, 14, 14, 32)   0           dense_5[0][0]                    
                                                                 average_pooling2d_2[0][0]        
__________________________________________________________________________________________________
conv4_dct (Conv2D)              (None, 12, 12, 32)   9216        multiply_2[0][0]                 
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 12, 12, 32)   128         conv4_dct[0][0]                  
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 12, 12, 32)   0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 32)           0           activation_4[0][0]               
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 16)           528         global_average_pooling2d_3[0][0] 
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 32)           544         dense_6[0][0]                    
__________________________________________________________________________________________________
multiply_3 (Multiply)           (None, 12, 12, 32)   0           dense_7[0][0]                    
                                                                 activation_4[0][0]               
__________________________________________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-01-12 04:36:44.922907: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-01-12 04:36:44.923361: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2399860000 Hz
2023-01-12 04:36:47.127251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-01-12 04:36:47.561519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-01-12 04:36:47.830407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-01-12 04:36:48.803245: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2023-01-12 04:36:48.855747: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
